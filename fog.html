<!DOCTYPE html>
<html>
<body style="margin:0;background:black;overflow:hidden;">
<canvas id="fog"></canvas>

<script>
const canvas = document.getElementById("fog");
const ctx = canvas.getContext("2d");

resize();
window.addEventListener("resize", resize);

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}

let particles = [];

class Particle {
  constructor(){
    this.x = canvas.width / 2 + (Math.random() - 0.5) * 40;
    this.y = canvas.height + Math.random() * 60;

    this.size = 15 + Math.random() * 40;

    this.speedY = 3 + Math.random() * 5;
    this.speedX = (Math.random() - 0.5) * 1;

    this.baseOpacity = 0.4 + Math.random() * 0.6;
    this.opacity = this.baseOpacity;

    this.fadeSpeed = 0.002 + Math.random() * 0.01; // random fade rate
    this.flickerSpeed = 0.01 + Math.random() * 0.05; // random flicker speed
    this.flickerOffset = Math.random() * 1000; // unique phase offset
  }

  update(time){
    this.y -= this.speedY;
    this.x += this.speedX;

    // Fade naturally
    this.opacity -= this.fadeSpeed;

    // Add soft flicker variation
    const flicker = Math.sin(time * this.flickerSpeed + this.flickerOffset) * 0.05;

    this.currentOpacity = Math.max(0, this.opacity + flicker);
  }

  draw(){
    ctx.beginPath();

    // Slight size-based transparency effect
    const sizeFade = this.size / 60;

    ctx.fillStyle = `rgba(200,200,200,${this.currentOpacity * sizeFade})`;
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

function spawn(){
  const count = 3 + Math.floor(Math.random() * 4); // random spawn amount
  for(let i=0;i<count;i++){
    particles.push(new Particle());
  }
}

function animate(time){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  spawn();

  for(let i = particles.length - 1; i >= 0; i--){
    particles[i].update(time * 0.001);
    particles[i].draw();

    if(particles[i].opacity <= 0){
      particles.splice(i,1);
    }
  }

  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
